%
% This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License.
% http://creativecommons.org/licenses/by-sa/4.0/
%

% DO NOT COMPILE THIS FILE DIRECTLY!
% This is included by the other .tex files.


\begin{frame}
    \includegraphics[scale=0.3]{images/logo-circl-Forensics.png}
    \begin{itemize}
        \item[]
        \item[]
        \item[] 1. Introduction
    \end{itemize}
\end{frame}


\begin{frame}
  \frametitle{1.1 Admin default behaviour}
  \begin{itemize}
    \item Get operational asap:
    \begin{itemize}
      \item Re-install
      \item Re-image
      \item Restore from backup
      \item[] $\to$ Destroy of evidences
      \item[]
    \end{itemize}
    \item Analyse the system on his own:
    \begin{itemize}
      \item Do some investigations
      \item Install and run (several) AV
      \item Apply updates for OS and Apps
      \item[] $\to$ Create big noise
      \item[] $\to$ Overwrite evidences
      \item[]
    \end{itemize}
    \item[] $\to$ Negative impact on forensics
  \end{itemize}
\end{frame}


\begin{frame}
  \frametitle{1.2 Preservation of evidences}
  \begin{itemize}
      \item Finding answers:
      \begin{itemize}
          \item[] $\to$ Is there an incident
          \item[] $\to$ System involved at all
          \item[] $\to$ If yes, how and when
          \item[] $\to$ System compromised
          \item[] $\to$ Malware/RAT involved
          \item[] $\to$ Persistence mechanisms
          \item[] $\to$ Root cause of the compromise
          \item[] $\to$ Lateral movement inside LAN
          \item[] $\to$ Access sensitive data
          \item[] $\to$ Data exfiltration
          \item[] $\to$ Illegal content
          \item[]
      \end{itemize}
      \item Legal case:
      \begin{itemize}
	  \item[] $\to$ Collect \& safe evidences
	  \item[] $\to$ Witness testimony for court
      \end{itemize}
  \end{itemize}
\end{frame}


\begin{frame}
  \frametitle{1.2 Preservation of evidences}
  \begin{itemize}
      \item A cyclic redundancy check (CRC) is not sufficient:
      \begin{itemize}
          \item Example: Checksum
          \begin{itemize}
		  \item[] 4711 $\to$ 13
          \end{itemize}
          \item Example: Collision
          \begin{itemize}
		  \item[] 12343 $\to$ 13
		  \item[] 
          \end{itemize}
      \end{itemize}
      \item Cryptographic hash function:
      \begin{itemize}
          \item Output always same fixed size
	  \item Deterministic: if $m = m \to h(m) = h(m)$
	  \item 1 Bit change in m $\to$ max. change in $h(m)$
	  \item One way function: For $h(m)$ impossible to find m
	  \item Simple collision resistance: For given $h(m1)$ hard to find $h(m2)$
	  \item Strong collision resistance: For any $h(m1)$ hard to find $h(m2)$
	  \item[]
      \end{itemize}
  \end{itemize}
\end{frame}


\begin{frame}
  \frametitle{1.3 Forensics Science}
  \begin{itemize}
    \item Classical forensic
    \begin{itemize}
      \item[] Locard's exchange principle
      \item[] {\scriptsize \url{https://en.wikipedia.org/wiki/Locard's\_exchange\_principle}}
    \end{itemize}
    \item[]
    \item Write down everything you see, hear, smell and do
    \item[]
    \item Chain of custody
    \begin{itemize}
        \item[] $\to$ {\scriptsize \url{https://csrc.nist.gov/glossary/term/chain\_of\_custody}}
        \item[] $\to$ {\scriptsize \url{https://www.nist.gov/document/sample-chain-custody-formdocx}}
    \end{itemize}
    \item[]
    \item Scope of the analysis
  \end{itemize}
\end{frame}


\begin{frame}
  \frametitle{1.3 Forensics Science}
  \begin{itemize}
      \item[] CPU registers $\to$ nanoseconds
      \item[] CPU cache $\to$ nanoseconds
      \item[] RAM memory $\to$ tens of nanoseconds
      \item[] Network state $\to$ milliseconds
      \item[] Processes running $\to$ seconds
      \item[] Disk, system settings, data $\to$ minutes
      \item[] External disks, backup $\to$ years
      \item[] Optical storage, printouts $\to$ tens of ears
      \item[] 
      \item[] $\to$ \url{https://www.circl.lu/pub/tr-22/}
  \end{itemize}
\end{frame}


\begin{frame}
  \frametitle{1.4 Forensic disciplines}
  \begin{itemize}
      \item Post-mortem Analysis
        \begin{itemize}
            \item[] $\to$ \url{https://www.circl.lu/pub/tr-22/}
            \item[] $\to$ \url{https://www.circl.lu/pub/tr-30/}
        \end{itemize}
      \item Memory Forensics
        \begin{itemize}
            \item[] $\to$ \url{https://www.circl.lu/pub/tr-22/}
            \item[] $\to$ \url{https://www.circl.lu/pub/tr-30/}
        \end{itemize}
      \item Reverse Engineering
      \item Code-Deobfuscation
      \item Network Forensics
      \item Mobile Forensics
      \item Cloud Forensics
  \end{itemize}
\end{frame}


\begin{frame}
  \frametitle{1.5 First Responder: Be prepared}
  \begin{itemize}
      \item Prepare your toolbox
      \begin{itemize}
          \item Write Blocker
          \item Photo camera
          \item Flash light, magnifying glasses
          \item Labelling device, labels, tags, stickers
          \item Toolkit, screwdriver kits
          \item Packing boxes, bags, faraday bag
          \item Cable kits, storage devices
          \item Anti-static band, network cables
          \item Pens, markers, notepads
          \item[] $\to$ Chain of custody
          \item Mouse jiggler
	  \item[]
      \end{itemize}
      \item Talk with people; Take notes
      \item Identify potential evidences (Computer, devices, paper, ...)
  \end{itemize}
\end{frame}


\begin{frame}
  \frametitle{1.5 First Responder: First steps}
  \begin{itemize}
      \item Powered-on versus powered-off
      \begin{itemize}
	  \item Shutdown: Lost of live (memory) data
          \item Pull power: Corrupt file system
          \item Live analysis: Modify memory and disk
          \item Live analysis: Working with compromised binaries?
	  \item[]
      \end{itemize}
      \item USB stick $\to$ \url{https://www.circl.lu/pub/tr-30/}
      \begin{itemize}
          \item 256 GB USB3
          \item File system: exFAT
          \item Memory dump: Comae-Toolkit
          \item Memory and Live Acquisition: FTK Imager Lite
          \item Encrypted Disk Detector - Edd
          \item Security Scanner: Nmap command line
          \item Sysinternals Suite
      \end{itemize}
  \end{itemize}
\end{frame}


\begin{frame}
  \frametitle{1.5 First Responder: Live response}
  \begin{enumerate}
	  \item Isolate system from (WiFi) network
      \item Perform memory dump
      \item In case of a live analysis:
      \begin{itemize}
          \item[] $\to$ System time
          \item[] $\to$ Logged-on users
          \item[] $\to$ Open files
          \item[] $\to$ Network -connections -status
          \item[] $\to$ Process information -memory
          \item[] $\to$ Process / port mapping
          \item[] $\to$ Clipboard content
          \item[] $\to$ Services
          \item[] $\to$ Command history
          \item[] $\to$ Mapped drives / shares
          \item[] $\to$ !!! Do not store information on the subject system !!!
      \end{itemize}
      \item Shutdown and do disk image (If possible)
      \item Logical image of live system $($Possible issues$)$
  \end{enumerate}
\end{frame}


\begin{frame}
  \frametitle{1.6 Post-mortem Analysis}
  \begin{itemize}
      \item Hardware layer \& acquisition
        \begin{itemize}
            \item[] Best copy (in the safe)
            \item[] Working copy (on a NAS)
            \item[] Working copy attached with Write Blocker
            \item[] Disk volumes and partitions
            \item[] Simple tools: dmesg, dd, mount
            \item[]
        \end{itemize}
      \item Sector layer
        \begin{itemize}
            \item[] Carving: foremost, scalpel, testdisk/photorec
            \item[] String search
            \item[]
        \end{itemize}
      \item File system layer
        \begin{itemize}
            \item[] FAT, NTFS
            \item[] File system timeline
            \item[] Restore deleted files
            \item[]
        \end{itemize}
  \end{itemize}
\end{frame}


\begin{frame}
  \frametitle{1.7 Post-mortem Analysis}
  \begin{itemize}
      \item OS layer
        \begin{itemize}
            \item[] Registry
            \item[] Event logs
            \item[] Volume shadow copies
            \item[] Prefetch files
            \item[]
        \end{itemize}
      \item Application layer
        \begin{itemize}
            \item[] AV logs
            \item[] Browser history: IE, firefox, chrome
            \item[] Email
            \item[] Office files \& PDFs
            \item[]
        \end{itemize}
      \item Searching for malware
        \begin{itemize}
            \item[] TEMP folders
            \item[] Startup folders
            \item[] Windows tasks
            \item[]
        \end{itemize}
  \end{itemize}
\end{frame}


\begin{frame}
  \frametitle{1.8 Forensic Distributions}
  \begin{itemize}
      \item Commercial
        \begin{itemize}
            \item[] \href{https://www.guidancesoftware.com/encase-forensic}{EnCase Forensic}
            \item[] \href{https://www.f-response.com/}{F-Response}
            \item[] \href{https://accessdata.com/products-services/forensic-toolkit-ftk}{Forensic Toolkit}
            \item[] \href{http://www.e-fense.com/products.php}{Helix Enterprise}
            \item[] \href{http://www.x-ways.net/forensics/index-d.html}{X-Ways Forensics}
            \item[] \href{https://www.magnetforensics.com/magnet-axiom/}{Magnet Axiom}
            \item[]
        \end{itemize}
      \item Open source tools
        \begin{itemize}
            \item[] \href{https://www.kali.org/}{Kali Linux}
            \item[] \href{https://www.sans.org/tools/sift-workstation/}{SANS SIFT}
            \item[]
        \end{itemize}
      \item Consider using your favorite Linux and add tools
      \item Sometimes a Windows based VM could be helpful
  \end{itemize}
\end{frame}



